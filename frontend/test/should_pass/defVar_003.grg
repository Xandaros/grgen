using attrib_model_001;

rule r
{
	ni:NINT;
	nb:NBOOL;
	ns:NSTRING;
	-ef:EFLOAT->;
	-ed:EDOUBLE->;
	-eo:EOBJECT->;

	p1:p();
	p2:p();

	modify {
		def var ai:int = 42;
		def var ab:boolean = true;
		def var as:string = "1337 0wn4g3 f0r ze lulz";
		def var af:float = 42.42424242f;
		def var ad:double = 42.42424242424242;
		def var ao:object = null;

		p1(ni.a, ef.a, yield ai, yield ab, yield as, yield af, yield ad, yield ao);
		p2(ai, af, yield ai, yield ab, yield as, yield af, yield ad, yield ao);
	}
}

pattern p modify(var in1:int, var in2:float, def var ai:int, def var ab:boolean, def var as:string,
									 def var af:float, def var ad:double, def var ao:object)
{
	ni:NINT;
	nb:NBOOL;
	ns:NSTRING;
	-ef:EFLOAT->;
	-ed:EDOUBLE->;
	-eo:EOBJECT->;

	modify {
		evalhere {
			ni.a = ai;
			nb.a = ab;
			ns.a = as;
			ef.a = af;
			ed.a = ad;
			eo.a = ao;
		}

		eval {
			yield ai = ni.a;
			yield ab = nb.a;
			yield as = ns.a;
			yield af = ef.a;
			yield ad = ed.a;
			yield ao = eo.a;
		}

		eval {
			yield ai = ai + ni.a;
			yield ab = ab | nb.a;
			yield as = as + ns.a;
			yield af = af + ef.a;
			yield ad = ad + ed.a;
			yield ao = ao==null ? eo.a : ao;
		}
	}
}
