using setmaptransaction;

rule transform1 {
	a:N;
	if{ "foo" in a.setVal; }
	if{ "foo" in a.mapVal; }
	
	modify {
		eval {
			a.setVal = a.setVal \ { "foo" };
			a.setVal = a.setVal | { "bar" };
			a.mapVal = a.mapVal \ { "foo" };
			a.mapVal = a.mapVal | { "bar"->"foo" };
		}
	}
}

rule transform2 {
	a:N;
	if{ "foo" in a.setVal; }
	if{ "foo" in a.mapVal; }
	
	modify {
		eval {
			a.setVal = a.setVal2;
			a.mapVal = a.mapVal2;
		}
	}
}

test fail {
	a:N;
	if{ "foo" in a.setVal; }
}
