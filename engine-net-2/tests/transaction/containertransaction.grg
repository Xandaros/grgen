using containertransaction;

rule transform1 {
	a:N;
	if{ "foo" in a.setVal; }
	if{ "foo" in a.mapVal; }
	if{ "foo" in a.arrayVal; }
	if{ "foo" in a.dequeVal; }
	
	modify {
		eval {
			a.setVal = a.setVal \ { "foo" };
			a.setVal = a.setVal | { "bar" };
			a.mapVal = a.mapVal \ { "foo" };
			a.mapVal = a.mapVal | { "bar"->"foo" };
			a.arrayVal = a.arrayVal + [ "bar" ];
			a.dequeVal = a.dequeVal + ] "bar" [;
		}
	}
}

rule transform2 {
	a:N;
	if{ "foo" in a.setVal; }
	if{ "foo" in a.mapVal; }
	if{ "foo" in a.arrayVal; }
	if{ "foo" in a.dequeVal; }
	
	modify {
		eval {
			a.setVal = a.setVal2;
			a.mapVal = a.mapVal2;
			a.arrayVal = a.arrayVal2;
			a.dequeVal = a.dequeVal2;
		}
	}
}

test fail {
	a:N;
	if{ "foo" in a.setVal; }
}
